<!DOCTYPE html>
<html lang="pt">
<head>
  <link rel="stylesheet" href="../styles/register.css">
  <meta charset="UTF-8">
  <title>Registar</title>
</head>
<body>
<form id="registerForm" action="login.html" method="POST">
  <input type="text"  name="nome"            placeholder="Nome"      required>
  <input type="email" name="email"           placeholder="Email"     required>
  <input type="password" name="password"        placeholder="Password"  required>
  <input type="password" name="repeat_password" placeholder="Repetir"   required>
  <button type="submit">Registar</button>
</form>

<script>
document.getElementById('registerForm').addEventListener('submit', async e => {
  e.preventDefault();                    // 1) trava o envio “normal”

  const f  = e.target;
  const pw = f.password.value;
  const pw2= f.repeat_password.value;

  if (pw !== pw2) {
    alert('Credenciais inválidas! As senhas não coincidem.');
    return;
  }

  // 2) constrói o corpo a enviar para signup.php
  const formData = new FormData(f);

  try {
    const r = await fetch('signup.php', {
      method: 'POST',
      body:   formData
    });
    const txt = await r.text();          // resposta vinda do PHP

    if (!r.ok) throw new Error('Falha no servidor');
    if (txt.includes('OK_REGISTO')) {    // nossa “senha” de sucesso
      window.location.href = 'login.html';
    } else {
      alert(txt);                        // mostra erro vindo do PHP
    }
  } catch (err) {
    alert('Erro: ' + err.message);
  }
});
</script>
</body>
</html>
